<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BORUSAN OTOMOTÄ°V Premium CRM</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>@keyframes spin{to{transform:rotate(360deg)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}.animate-spin{animation:spin 1s linear infinite}.animate-pulse{animation:pulse 2s cubic-bezier(0.4,0,0.6,1) infinite}</style>
</head>
<body>
<div id="root"></div>
<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
const firebaseConfig = {
  apiKey: "AIzaSyDUf2hQIzOoTNd3bGFLdHZvd_KBtFRj7j8",
  authDomain: "borusan-crm.firebaseapp.com",
  projectId: "borusan-crm",
  storageBucket: "borusan-crm.firebasestorage.app",
  messagingSenderId: "488490232677",
  appId: "1:488490232677:web:fbd860d63c3121a1bc8f8c"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
window.firebaseDb = db;
window.firebaseModules = { collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, serverTimestamp };
</script>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script type="text/babel">
const{useState,useEffect}=React;const Icon=({path,className="w-5 h-5"})=>(<svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d={path}/></svg>);const icons={plus:"M12 4v16m8-8H4",edit:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",trash:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",search:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",phone:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",mail:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",car:"M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z",refresh:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15",close:"M6 18L18 6M6 6l12 12",check:"M5 13l4 4L19 7",activity:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",dollar:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",trend:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6",target:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"};function BorusanCRM(){const[customers,setCustomers]=useState([]);const[searchTerm,setSearchTerm]=useState('');const[filterStatus,setFilterStatus]=useState('all');const[showForm,setShowForm]=useState(false);const[editingId,setEditingId]=useState(null);const[loading,setLoading]=useState(false);const[syncing,setSyncing]=useState(false);const[formData,setFormData]=useState({name:'',phone:'',email:'',carModel:'',status:'Ä°lk Temas',price:'',dbsAmount:'',notes:''});const db=window.firebaseDb;const{collection,addDoc,updateDoc,deleteDoc,doc,onSnapshot,serverTimestamp}=window.firebaseModules;useEffect(()=>{if(!db)return;setSyncing(true);const unsubscribe=onSnapshot(collection(db,'customers'),(snapshot)=>{const customerData=snapshot.docs.map(doc=>({id:doc.id,...doc.data()}));setCustomers(customerData);setSyncing(false);});return()=>unsubscribe();},[db]);const statusOptions=['Ä°lk Temas','Scoring YapÄ±ldÄ±','Teklif GÃ¶nderildi','GÃ¶rÃ¼ÅŸme YapÄ±ldÄ±','Onay Bekleniyor','Rezervasyon YapÄ±ldÄ±','Teslim Edildi','Ä°ptal','TamamlandÄ±'];const statusConfig={'Ä°lk Temas':{bgLight:'bg-blue-50',textColor:'text-blue-700'},'Scoring YapÄ±ldÄ±':{bgLight:'bg-indigo-50',textColor:'text-indigo-700'},'Teklif GÃ¶nderildi':{bgLight:'bg-purple-50',textColor:'text-purple-700'},'GÃ¶rÃ¼ÅŸme YapÄ±ldÄ±':{bgLight:'bg-yellow-50',textColor:'text-yellow-700'},'Onay Bekleniyor':{bgLight:'bg-orange-50',textColor:'text-orange-700'},'Rezervasyon YapÄ±ldÄ±':{bgLight:'bg-green-50',textColor:'text-green-700'},'Teslim Edildi':{bgLight:'bg-teal-50',textColor:'text-teal-700'},'Ä°ptal':{bgLight:'bg-red-50',textColor:'text-red-700'},'TamamlandÄ±':{bgLight:'bg-gray-50',textColor:'text-gray-700'}};const handleSubmit=async()=>{if(!formData.name||!formData.phone||!formData.carModel){alert('âš ï¸ MÃ¼ÅŸteri AdÄ±, Telefon ve AraÃ§ Modeli zorunludur!');return;}setLoading(true);try{if(editingId){const customerRef=doc(db,'customers',editingId);await updateDoc(customerRef,{...formData,updatedAt:serverTimestamp()});}else{await addDoc(collection(db,'customers'),{...formData,createdAt:serverTimestamp(),updatedAt:serverTimestamp()});}resetForm();}catch(error){alert('Hata: '+error.message);}finally{setLoading(false);}};const handleEdit=(customer)=>{setFormData({name:customer.name||'',phone:customer.phone||'',email:customer.email||'',carModel:customer.carModel||'',status:customer.status||'Ä°lk Temas',price:customer.price||'',dbsAmount:customer.dbsAmount||'',notes:customer.notes||''});setEditingId(customer.id);setShowForm(true);window.scrollTo({top:0,behavior:'smooth'});};const handleDelete=async(id)=>{if(window.confirm('ðŸ—‘ï¸ Bu mÃ¼ÅŸteriyi silmek istediÄŸinizden emin misiniz?')){setLoading(true);try{await deleteDoc(doc(db,'customers',id));}catch(error){alert('Hata: '+error.message);}finally{setLoading(false);}}};const resetForm=()=>{setFormData({name:'',phone:'',email:'',carModel:'',status:'Ä°lk Temas',price:'',dbsAmount:'',notes:''});setEditingId(null);setShowForm(false);};const handleExcelUpload=async(e)=>{const file=e.target.files[0];if(!file)return;setLoading(true);try{const data=await file.arrayBuffer();const workbook=XLSX.read(data);const sheetName=workbook.SheetNames[0];const worksheet=workbook.Sheets[sheetName];const jsonData=XLSX.utils.sheet_to_json(worksheet);let successCount=0;for(const row of jsonData){if(row['MÃ¼ÅŸteri AdÄ±']&&row['Telefon']&&row['AraÃ§']){await addDoc(collection(db,'customers'),{name:row['MÃ¼ÅŸteri AdÄ±']||'',phone:String(row['Telefon']||''),email:row['E-posta']||'',carModel:row['AraÃ§']||'',status:row['Durum']||'Ä°lk Temas',price:String(row['Fiyat']||''),dbsAmount:String(row['DBS']||''),notes:row['Notlar']||'',createdAt:serverTimestamp(),updatedAt:serverTimestamp()});successCount++;}}alert(`âœ… ${successCount} mÃ¼ÅŸteri baÅŸarÄ±yla eklendi!`);e.target.value='';}catch(error){alert('Hata: '+error.message);}finally{setLoading(false);}};const downloadExcelTemplate=()=>{const template=[{['MÃ¼ÅŸteri AdÄ±']:'Ahmet YÄ±lmaz',['Telefon']:'05551234567',['E-posta']:'ahmet@example.com',['AraÃ§']:'BMW 5 Serisi',['Durum']:'Ä°lk Temas',['Fiyat']:'50000',['DBS']:'5000',['Notlar']:'Ã–rnek not'}];const ws=XLSX.utils.json_to_sheet(template);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'MÃ¼ÅŸteriler');XLSX.writeFile(wb,'borusan-musteri-sablonu.xlsx');};const filteredCustomers=customers.filter(customer=>{const matchesSearch=customer.name?.toLowerCase().includes(searchTerm.toLowerCase())||customer.phone?.includes(searchTerm)||customer.carModel?.toLowerCase().includes(searchTerm.toLowerCase());const matchesFilter=filterStatus==='all'||customer.status===filterStatus;return matchesSearch&&matchesFilter;});const totalRevenue=customers.filter(c=>c.price).reduce((sum,c)=>sum+(parseFloat(c.price.replace(/[^0-9.-]/g,''))||0),0);const totalDBS=customers.filter(c=>c.dbsAmount).reduce((sum,c)=>sum+(parseFloat(c.dbsAmount.replace(/[^0-9.-]/g,''))||0),0);return(<div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6"><div className="max-w-7xl mx-auto"><div className="bg-gradient-to-r from-blue-600 to-indigo-700 rounded-2xl shadow-2xl p-8 mb-6 relative overflow-hidden"><div className="absolute top-0 right-0 w-64 h-64 bg-white opacity-5 rounded-full -mr-32 -mt-32"></div><div className="relative"><div className="flex items-center justify-between mb-6"><div><div className="flex items-center gap-3 mb-2"><Icon path={icons.car} className="w-10 h-10 text-white"/><h1 className="text-4xl font-black text-white">BORUSAN OTOMOTÄ°V</h1></div><p className="text-blue-100 text-lg font-medium ml-13">Premium Kiralama CRM</p><div className="flex items-center gap-2 mt-2 ml-13"><div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div><span className="text-blue-100 text-sm">ðŸ”¥ GerÃ§ek ZamanlÄ± Firebase</span>{syncing&&<span className="text-blue-200 text-xs ml-2">GÃ¼ncelleniyor...</span>}</div></div><div className="flex gap-3"><input type="file" id="excel-upload" accept=".xlsx,.xls" onChange={handleExcelUpload} className="hidden"/><button onClick={downloadExcelTemplate} className="flex items-center gap-2 bg-purple-600 text-white px-5 py-3 rounded-xl hover:bg-purple-700 transition-all font-bold"><span className="text-lg">ðŸ“¥</span>Åžablon Ä°ndir</button><button onClick={()=>document.getElementById('excel-upload').click()} disabled={loading} className="flex items-center gap-2 bg-green-600 text-white px-5 py-3 rounded-xl hover:bg-green-700 transition-all font-bold disabled:opacity-50"><span className="text-lg">ðŸ“Š</span>Excel YÃ¼kle</button><button onClick={()=>setShowForm(!showForm)} className="flex items-center gap-2 bg-white text-blue-600 px-6 py-3 rounded-xl hover:bg-blue-50 transition-all font-bold"><Icon path={icons.plus} className="w-5 h-5"/>Yeni MÃ¼ÅŸteri</button></div></div><div className="grid grid-cols-5 gap-4"><div className="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20"><div className="flex items-center gap-3"><div className="bg-blue-500 p-3 rounded-lg"><Icon path={icons.activity} className="w-6 h-6 text-white"/></div><div><div className="text-3xl font-bold text-white">{customers.length}</div><div className="text-blue-100 text-sm">Toplam MÃ¼ÅŸteri</div></div></div></div><div className="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20"><div className="flex items-center gap-3"><div className="bg-green-500 p-3 rounded-lg"><Icon path={icons.check} className="w-6 h-6 text-white"/></div><div><div className="text-3xl font-bold text-white">{customers.filter(c=>c.status==='Rezervasyon YapÄ±ldÄ±'||c.status==='Teslim Edildi').length}</div><div className="text-blue-100 text-sm">Aktif Kiralama</div></div></div></div><div className="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20"><div className="flex items-center gap-3"><div className="bg-purple-500 p-3 rounded-lg"><Icon path={icons.target} className="w-6 h-6 text-white"/></div><div><div className="text-3xl font-bold text-white">{customers.filter(c=>c.status==='Scoring YapÄ±ldÄ±').length}</div><div className="text-blue-100 text-sm">Scoring YapÄ±ldÄ±</div></div></div></div><div className="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20"><div className="flex items-center gap-3"><div className="bg-yellow-500 p-3 rounded-lg"><Icon path={icons.dollar} className="w-6 h-6 text-white"/></div><div><div className="text-2xl font-bold text-white">{totalRevenue.toLocaleString('tr-TR')} â‚º</div><div className="text-blue-100 text-sm">Toplam Gelir</div></div></div></div><div className="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20"><div className="flex items-center gap-3"><div className="bg-indigo-500 p-3 rounded-lg"><Icon path={icons.trend} className="w-6 h-6 text-white"/></div><div><div className="text-2xl font-bold text-white">{totalDBS.toLocaleString('tr-TR')} â‚º</div><div className="text-blue-100 text-sm">Toplam DBS</div></div></div></div></div></div></div>{showForm&&(<div className="bg-white rounded-2xl shadow-2xl p-8 mb-6"><div className="flex items-center justify-between mb-6"><h2 className="text-2xl font-bold text-slate-800">âš¡ {editingId?'MÃ¼ÅŸteri DÃ¼zenle':'Yeni MÃ¼ÅŸteri Ekle'}</h2><button onClick={resetForm} className="text-slate-400 hover:text-slate-600"><Icon path={icons.close} className="w-6 h-6"/></button></div><div className="grid grid-cols-2 gap-6"><div><label className="block text-sm font-bold text-slate-700 mb-2">MÃ¼ÅŸteri AdÄ± <span className="text-red-500">*</span></label><input type="text" value={formData.name} onChange={(e)=>setFormData({...formData,name:e.target.value})} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="MÃ¼ÅŸteri adÄ±nÄ± girin"/></div><div><label className="block text-sm font-bold text-slate-700 mb-2">Telefon <span className="text-red-500">*</span></label><input type="tel" value={formData.phone} onChange={(e)=>setFormData({...formData,phone:e.target.value})} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="0555 123 45 67"/></div><div><label className="block text-sm font-bold text-slate-700 mb-2">E-posta</label><input type="email" value={formData.email} onChange={(e)=>setFormData({...formData,email:e.target.value})} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="musteri@email.com"/></div><div><label className="block text-sm font-bold text-slate-700 mb-2">AraÃ§ Modeli <span className="text-red-500">*</span></label><input type="text" value={formData.carModel} onChange={(e)=>setFormData({...formData,carModel:e.target.value})} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="BMW 5 Serisi..."/></div><div><label className="block text-sm font-bold text-slate-700 mb-2">Durum</label><select value={formData.status} onChange={(e)=>setFormData({...formData,status:e.target.value})} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500">{statusOptions.map(s=><option key={s} value={s}>{s}</option>)}</select></div><div><label className="block text-sm font-bold text-slate-700 mb-2">Fiyat (â‚º)</label><input type="text" value={formData.price} onChange={(e)=>setFormData({...formData,price:e.target.value})} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="50000"/></div><div className="col-span-2"><label className="block text-sm font-bold text-slate-700 mb-2">DBS MiktarÄ± (â‚º)</label><input type="text" value={formData.dbsAmount} onChange={(e)=>setFormData({...formData,dbsAmount:e.target.value})} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="DBS miktarÄ±"/></div><div className="col-span-2"><label className="block text-sm font-bold text-slate-700 mb-2">Notlar</label><textarea value={formData.notes} onChange={(e)=>setFormData({...formData,notes:e.target.value})} rows="3" className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="Notlar..."></textarea></div><div className="col-span-2 flex gap-4 mt-4"><button onClick={handleSubmit} disabled={loading} className="flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-8 py-4 rounded-xl hover:from-blue-700 hover:to-indigo-700 font-bold text-lg disabled:opacity-50">{loading?'Kaydediliyor...':(editingId?'âœ“ GÃ¼ncelle':'+ Kaydet')}</button><button onClick={resetForm} className="flex-1 bg-slate-200 text-slate-700 px-8 py-4 rounded-xl hover:bg-slate-300 font-bold text-lg">Ä°ptal</button></div></div></div>)}<div className="bg-white rounded-2xl shadow-lg p-6 mb-6"><div className="grid grid-cols-2 gap-4"><div className="relative"><Icon path={icons.search} className="w-5 h-5 absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400"/><input type="text" placeholder="MÃ¼ÅŸteri adÄ±, telefon veya araÃ§ ara..." value={searchTerm} onChange={(e)=>setSearchTerm(e.target.value)} className="w-full pl-12 pr-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500"/></div><select value={filterStatus} onChange={(e)=>setFilterStatus(e.target.value)} className="px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500"><option value="all">ðŸ“Š TÃ¼m Durumlar</option>{statusOptions.map(s=><option key={s} value={s}>{s}</option>)}</select></div></div><div className="bg-white rounded-2xl shadow-2xl overflow-hidden"><div className="overflow-x-auto"><table className="w-full"><thead className="bg-gradient-to-r from-slate-50 to-slate-100 border-b-2"><tr><th className="px-6 py-4 text-left text-xs font-black text-slate-700 uppercase">MÃ¼ÅŸteri</th><th className="px-6 py-4 text-left text-xs font-black text-slate-700 uppercase">Ä°letiÅŸim</th><th className="px-6 py-4 text-left text-xs font-black text-slate-700 uppercase">AraÃ§</th><th className="px-6 py-4 text-left text-xs font-black text-slate-700 uppercase">Durum</th><th className="px-6 py-4 text-left text-xs font-black text-slate-700 uppercase">Fiyat</th><th className="px-6 py-4 text-left text-xs font-black text-slate-700 uppercase">DBS</th><th className="px-6 py-4 text-left text-xs font-black text-slate-700 uppercase">Ä°ÅŸlemler</th></tr></thead><tbody className="divide-y">{filteredCustomers.length===0?(<tr><td colSpan="7" className="px-6 py-16 text-center"><div className="flex flex-col items-center gap-4"><Icon path={icons.activity} className="w-16 h-16 text-slate-300"/><p className="text-slate-500 text-lg">{syncing?'Firebase baÄŸlanÄ±yor...':'HenÃ¼z mÃ¼ÅŸteri yok. Hemen ekleyin!'}</p></div></td></tr>):(filteredCustomers.map(customer=>(<tr key={customer.id} className="hover:bg-blue-50 transition-colors"><td className="px-6 py-4"><div className="font-bold text-slate-900 text-lg">{customer.name}</div>{customer.notes&&<div className="text-sm text-slate-500 italic">{customer.notes.slice(0,60)}...</div>}</td><td className="px-6 py-4"><div className="flex items-center gap-2 text-slate-700"><Icon path={icons.phone} className="w-4 h-4 text-blue-500"/>{customer.phone}</div>{customer.email&&(<div className="flex items-center gap-2 text-slate-600 text-sm mt-1"><Icon path={icons.mail} className="w-4 h-4"/>{customer.email}</div>)}</td><td className="px-6 py-4"><div className="flex items-center gap-2 font-bold text-slate-900"><Icon path={icons.car} className="w-5 h-5 text-indigo-500"/>{customer.carModel}</div></td><td className="px-6 py-4"><span className={`inline-flex px-4 py-2 rounded-full font-bold text-sm ${statusConfig[customer.status]?.bgLight} ${statusConfig[customer.status]?.textColor}`}>{customer.status}</span></td><td className="px-6 py-4"><div className="text-lg font-bold text-green-600">{customer.price?`${parseFloat(customer.price).toLocaleString('tr-TR')} â‚º`:'-'}</div></td><td className="px-6 py-4"><div className="text-lg font-bold text-purple-600">{customer.dbsAmount?`${parseFloat(customer.dbsAmount).toLocaleString('tr-TR')} â‚º`:'-'}</div></td><td className="px-6 py-4"><div className="flex gap-2"><button onClick={()=>handleEdit(customer)} className="p-2 text-blue-600 hover:bg-blue-100 rounded-lg"><Icon path={icons.edit} className="w-5 h-5"/></button><button onClick={()=>handleDelete(customer.id)} className="p-2 text-red-600 hover:bg-red-100 rounded-lg"><Icon path={icons.trash} className="w-5 h-5"/></button></div></td></tr>)))}</tbody></table></div></div></div></div>);}
const root=ReactDOM.createRoot(document.getElementById('root'));root.render(<BorusanCRM/>);
</script>
</body>
</html>
